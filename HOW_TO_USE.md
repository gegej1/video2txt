# 🎯 Video2Txt 使用说明

## 最简单的使用方式

### 第一步：启动应用

打开终端（Terminal），进入项目目录，运行：

```bash
./start.sh
```

你会看到类似这样的输出：

```
========================================
   Video2Txt Web 应用启动脚本
========================================

✓ Python 版本: Python 3.12.7
✓ 所有依赖已就绪

========================================
  启动 Web 服务器...
========================================

cwd= /Users/xxx/video2txt/app dirname= /Users/xxx/video2txt/app

============================================================
Video2Txt Web 应用正在启动...
============================================================
上传目录: /Users/xxx/video2txt/uploads
输出目录: /Users/xxx/video2txt/outputs

请在浏览器中打开: http://localhost:5000
按 Ctrl+C 停止服务
============================================================

 * Serving Flask app 'app'
 * Debug mode: on
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.x.x:5000
```

### 第二步：打开浏览器

在浏览器地址栏输入：

```
http://localhost:5000
```

你会看到一个漂亮的紫色渐变界面。

### 第三步：上传文件

**方式 A - 拖拽上传**（推荐）
1. 找到你要转写的视频或音频文件
2. 用鼠标拖到浏览器窗口的上传区域
3. 看到文件名显示后松开鼠标

**方式 B - 点击上传**
1. 点击上传区域
2. 在弹出的文件选择器中选择文件
3. 点击"打开"

### 第四步：选择模型

在下拉菜单中选择：

- **Small**：适合快速测试，几分钟内完成
- **Medium**：⭐ 推荐，准确率高，适合大多数场景
- **Large**：最高质量，但处理时间较长

> 💡 首次使用某个模型时，会自动下载模型文件（几分钟到十几分钟）

### 第五步：开始转换

点击"开始转换"按钮，然后：

1. **等待上传**：文件上传到服务器（进度 0-10%）
2. **加载模型**：加载 Whisper 模型（进度 10-30%）
3. **转写中**：这是最耗时的步骤（进度 30-80%）
4. **保存结果**：保存文本文件（进度 80-100%）

### 第六步：查看和下载结果

转换完成后，你会看到：

- ✅ 转写结果直接显示在页面上
- 💾 点击"下载文本"按钮，保存为 `.txt` 文件
- 🔄 点击"转换新文件"继续处理其他文件

---

## 实际操作示例

### 场景 1：转写一段视频采访

```
1. 启动应用：./start.sh
2. 浏览器打开：http://localhost:5000
3. 拖入文件：interview.mp4
4. 选择模型：Medium（推荐）
5. 点击：开始转换
6. 等待：约 5-10 分钟（取决于视频长度）
7. 完成：下载 interview.txt
```

### 场景 2：批量转写多个文件

**选项 A - Web 应用逐个处理**
```
1. 处理第一个文件
2. 下载结果
3. 点击"转换新文件"
4. 继续处理下一个
```

**选项 B - 命令行批量处理**（推荐批量）
```bash
# 1. 将所有视频放入 videos 文件夹
cp video1.mp4 video2.mp4 video3.mp4 videos/

# 2. 运行批量脚本
python3 batch_transcribe.py

# 3. 在 whisper_output 文件夹查看结果
ls whisper_output/
```

---

## 处理时间参考

| 文件长度 | Small 模型 | Medium 模型 | Large 模型 |
|---------|-----------|------------|-----------|
| 5 分钟   | ~2 分钟    | ~5 分钟     | ~10 分钟   |
| 30 分钟  | ~10 分钟   | ~20 分钟    | ~40 分钟   |
| 1 小时   | ~20 分钟   | ~40 分钟    | ~80 分钟   |

> ⚠️ 实际时间取决于你的电脑性能

---

## 故障排查

### 问题：浏览器打不开页面

**解决方案**：
1. 检查终端是否显示"Running on..."
2. 确认访问 `http://localhost:5000`（不是 https）
3. 尝试访问 `http://127.0.0.1:5000`

### 问题：上传后一直卡在"正在处理"

**解决方案**：
1. 检查终端是否有错误信息
2. 确认模型是否下载完成
3. 刷新浏览器页面重试

### 问题：转写结果不准确

**解决方案**：
1. 使用更大的模型（Large）
2. 确保音频清晰
3. 如果是方言，尝试使用英文模型

### 问题：内存不足

**解决方案**：
1. 使用 Small 模型
2. 关闭其他程序释放内存
3. 处理较短的视频片段

---

## 高级技巧

### 技巧 1：处理英文内容

编辑 `app/app.py` 第 129 行：

```python
result = model.transcribe(
    task['file_path'],
    language='English',  # 改为 English
    verbose=False
)
```

### 技巧 2：生成字幕文件

使用命令行工具：

```bash
python3 video2txt.py video.mp4 medium srt zh
```

这会生成带时间戳的 `.srt` 字幕文件。

### 技巧 3：在其他设备访问

1. 查看本机 IP：
   ```bash
   # macOS/Linux
   ifconfig | grep "inet "

   # Windows
   ipconfig
   ```

2. 在同一 WiFi 的其他设备浏览器访问：
   ```
   http://192.168.x.x:5000
   ```

---

## 停止应用

在终端按 `Ctrl + C` 停止服务器。

---

## 文件位置说明

| 位置 | 说明 |
|------|------|
| `uploads/` | 临时上传文件（处理后自动删除） |
| `outputs/` | Web 应用转写结果 |
| `whisper_output/` | 批量脚本转写结果 |
| `~/.cache/whisper/` | Whisper 模型文件缓存 |

---

## 获取更多帮助

- 📘 快速开始：[QUICK_START.md](QUICK_START.md)
- 📖 详细指南：[WEB_APP_GUIDE.md](WEB_APP_GUIDE.md)
- 📊 项目总结：[PROJECT_SUMMARY.md](PROJECT_SUMMARY.md)
- 💻 技术文档：[README.md](README.md)

---

**现在就开始吧！**

```bash
./start.sh
```

然后在浏览器打开：**http://localhost:5000** 🚀
